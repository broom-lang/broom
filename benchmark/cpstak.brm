fun cpsTak x y z = begin
  fun tak x y z k =
    match y < x
    | False -> k z
    | True ->
      tak (x - 1) y z
          (fn v ->
            tak (y - 1) z x
                (fn v' ->
                  tak (z - 1) x y
                      (fn v'' ->
                        tak v v' v'' k)))
    end

  ; tak x y z (fn res -> res)
end

